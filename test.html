<!doctype html>
<meta charset="ascii">
<textarea id="code" rows=25 cols=80>
type abc = 3;
type bat = "fly";
</textarea>

<p><input type=button onclick="go()" value="tokenize"></p>
<textarea id="out" rows=25 cols=80>
</textarea>
<p><input type=button onclick="onparse()" value="parse"></p>
<textarea id="parsed" rows=25 cols=80>
</textarea>

<div id="tree"></div>

<script>
var exports = window;

Object.prototype.error = function(s, t) {
  console.log(s);
}

var tokens;
var go = function(){
  var code = document.getElementById("code").value;
  var out = document.getElementById("out")
  out.value = "";
  var t = tokenize_string(code);
  tokens = [];
  while(true) {
    var e = t.get()
    out.value += JSON.stringify(e) + "\n";
    if(e.type != "whitespace") {
     if(e.type == "(end)") { break; }
     tokens.push(e);
    }
  }
}

var tree;
var onparse = function() {
  console.log("parsing");
  var out = document.getElementById("parsed")
  out.value = "";
  /*if(tokens.length == 0) {
    out.value = "Please tokenize first";
    return;
  }*/
  var i = 0;
  var code = document.getElementById("code").value;
  tree = parse(tokenize_string(code));
  out.value = JSON.stringify(tree,
    ["value", "name", "first", "second", "third", "fourth", "arity"], '  ');

  var pic = draw(tree);
  var i = document.getElementById('tree');
  i.appendChild(pic);
}

</script>
<script src="tokenizer.js"></script>
<script src="parse.js"></script>
<script src="drawtree.js"></script>

