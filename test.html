<!doctype html>
<meta charset="ascii">

<textarea id="code" rows=25 cols=80>
int main(int argc, char **argv) {
  puts("Hello, World!");
  return 0;
}
</textarea>

<p><input type=button onclick="go()" value="tokenize"></p>
<textarea id="out" rows=25 cols=80>
</textarea>
<p><input type=button onclick="onparse()" value="parse"></p>
<textarea id="parsed" rows=25 cols=80>
</textarea>

<script>
var exports = window;

Object.prototype.error = function(s) {
  console.log(s);
}

var tokens;
var go = function(){
  var code = document.getElementById("code").value;
  var out = document.getElementById("out")
  out.value = "";
  var t = tokenize_string(code);
  tokens = [];
  while(true) {
    var e = t.get()
    if(e.type != "whitespace") {
     tokens.push(e);
     if(e.type == "(end)") { break; }
     out.value += e.value + "\n";
    }
  }
}

var onparse = function() {
  var out = document.getElementById("parsed")
  out.value = "";
  if(tokens.length == 0) {
    out.value = "Please tokenize first";
    return;
  }
  var i = 0;
  out.value = parse({
    get: function(){return tokens[i++];}
  });
}

</script>
<script src="tokenizer.js"></script>
<script src="parse.js"></script>
