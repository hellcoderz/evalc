<head>
<script src="../lib/codemirror/lib/codemirror.js"></script>
<script src="../styles/codemirror/clike.js"></script>
<script src="c.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/dojo/1.7.2/dojo/dojo.js" data-dojo-config="async: true"></script>
<script src="walk.js"></script>
<link rel="stylesheet" href="../lib/codemirror/lib/codemirror.css">
</head>
<body>
<p>parsing demo</p>
<script type="text/javascript">
var editor = CodeMirror(document.body, {
                        value: "int main() {\n  return 0;\n}",
                        mode: "text/x-csrc",
                        lineNumbers: true,
                        onChange: parsec
                       });
function walkprint(astnode, c) {
  console.log(astnode.node_type);
}
  var result;
function parsec() {
  require(["dojox/json/ref"], function(ref) {
  try { result = c.parse(editor.getValue()); }
  catch (err) { result = err.message; }

  if(typeof(result) == "object") {
    typecheck(result);
    console.log("well-typed.");
  }

  var to = document.getElementById('parse');
  if(to == null) return;
  if(result != null)
    to.innerHTML = ref.toJson(result, true);
  else 
    to.innerHTML = "error";
  });
}
</script>
<pre id="parse">
</pre>
<script type="text/javascript">
parsec();
</script>
</body>
